1.

SELECT t1.'Компания', t1.'Год', t1.'Месяц', t1.'Тип вагона', t1.'Количество вагонов', COUNT(*) AS 'Количество дублей'
FROM 'Таблица перевозок' AS t1
GROUP BY t1.'Компания', t1.'Год', t1.'Месяц', t1.'Тип вагона', t1.'Количество вагонов'
HAVING COUNT(*) > 1;


2.

SELECT t1.'Компания'
FROM FROM 'Таблица перевозок' AS t1
WHERE 'Год' = 2020 ORDER BY 'Количество вагонов' DESC
LIMIT 1;


3.

SELECT t1.*
FROM 'Таблица перевозок' AS t1
INNER JOIN 'Справочник компаний' AS t2 ON t1.'Компания' = t2.'Компания'
WHERE t2.'Компания' LIKE '%Москва%' AND t2.'Дата основания' < '01.01.2020'


4.

SELECT AVG(t1.'Количество вагонов'), t2.'Страна'
FROM 'Таблица перевозок' AS t1
INNER JOIN 'Справочник компаний' AS t2 ON t1.'Компания' = t2.'Компания'
INNER JOIN 'Идентефикаторы компаний' AS t3 ON t2.'id_company' = t3.'id_company'
WHERE t3.'ОКПО' > 1000000
GROUP BY t2.'Страна'


5.

DELETE FROM 'Таблица перевозок' AS t1
INNER JOIN 'Справочник компаний' AS t2 ON t1.'Компания' = t2.'Компания'
WHERE t1.'ГОД' = 2019 AND t2.'Страна' = 'Россия'


6.

UPDATE 'Таблица перевозок' AS t1
INNER JOIN 'Справочник компаний' AS t2 ON t1.'Компания' = t2.'Компания'
SET t1.'Тип вагона' = 'Крытые'
WHERE t2.'Адрес' LIKE '%Санкт-Петербург%' AND t1.'Год' = 2019 AND t1.'Месяц' = 'Август'
